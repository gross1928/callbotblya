# üî¨ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥—Å—á–µ—Ç –ö–ë–ñ–£ –≤ –±–æ—Ç–µ "–î–∞–ï–¥–∞"

## üìä –û–±—â–∞—è —Å—Ö–µ–º–∞

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –§–æ—Ç–æ/–¢–µ–∫—Å—Ç ‚Üí –ò–ò –∞–Ω–∞–ª–∏–∑ ‚Üí –ë–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ ‚Üí –¢–æ—á–Ω—ã–π –ö–ë–ñ–£
```

---

## üñºÔ∏è –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–Ω–∞–ª–∏–∑ –§–û–¢–û –µ–¥—ã

### –®–∞–≥ 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ
–ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –±–ª—é–¥–∞ —á–µ—Ä–µ–∑ Telegram.

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ USE_PRODUCTS_DATABASE
```typescript
// src/utils/openai.ts -> analyzeFoodFromPhoto()

if (config.food.useProductsDatabase) {
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑—É –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–¢–û–ß–ù–û!)
} else {
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –ò–ò (–º–µ–Ω–µ–µ —Ç–æ—á–Ω–æ)
}
```

### –®–∞–≥ 3: Vision AI —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã (GPT-5-nano)
```typescript
// src/utils/openai.ts -> analyzeFoodPhotoIngredientsOnly()
```

**–ò–ò –¢–û–õ–¨–ö–û –Ω–∞—Ö–æ–¥–∏—Ç –ø—Ä–æ–¥—É–∫—Ç—ã –∏ –≤–µ—Å, –ù–ï —Å—á–∏—Ç–∞–µ—Ç –ö–ë–ñ–£:**
```json
{
  "dish_name": "–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ —Å —Ä–∏—Å–æ–º",
  "ingredients": [
    {"product": "–∫—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞", "weight": 200},
    {"product": "—Ä–∏—Å –±–µ–ª—ã–π –≤–∞—Ä–µ–Ω—ã–π", "weight": 150}
  ]
}
```

### –®–∞–≥ 4: –ü–æ–∏—Å–∫ –≤ –±–∞–∑–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ üîç
```typescript
// src/utils/openai.ts -> enrichWithDatabaseNutrition()
```

**–î–ª—è –ö–ê–ñ–î–û–ì–û –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞:**
1. –ü–æ–∏—Å–∫ –≤ –±–∞–∑–µ Supabase (fuzzy + full-text search)
2. –†–∞—Å—á–µ—Ç –ö–ë–ñ–£ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤–µ—Å–∞
3. Fallback –Ω–∞ AI –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
```json
{
  "name": "–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ —Å —Ä–∏—Å–æ–º",
  "ingredients": ["–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ 200–≥", "–†–∏—Å –±–µ–ª—ã–π —à–ª–∏—Ñ–æ–≤–∞–Ω–Ω—ã–π –≤–∞—Ä–µ–Ω—ã–π 150–≥"],
  "weight": 350,
  "calories": 421,    // –¢–û–ß–ù–û –∏–∑ –±–∞–∑—ã!
  "protein": 50.7,    // –¢–û–ß–ù–û –∏–∑ –±–∞–∑—ã!
  "fat": 4.1,         // –¢–û–ß–ù–û –∏–∑ –±–∞–∑—ã!
  "carbs": 43.0       // –¢–û–ß–ù–û –∏–∑ –±–∞–∑—ã!
}
```

### ‚úÖ –ë–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –¢–ï–ü–ï–†–¨ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–æ—Ç–æ!
–¢–æ—á–Ω–æ—Å—Ç—å –ø–æ–≤—ã—Å–∏–ª–∞—Å—å —Å 60-75% –¥–æ **95-99%**! üéØ

---

## ‚úçÔ∏è –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–Ω–∞–ª–∏–∑ –¢–ï–ö–°–¢–ê (–Ω–æ–≤–∞—è —É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –±–∞–∑–æ–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤!)

### –®–∞–≥ 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ
–ù–∞–ø—Ä–∏–º–µ—Ä: `"–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ 200–≥ —Å –≥—Ä–µ—á–∫–æ–π 100–≥"`

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ USE_PRODUCTS_DATABASE
```typescript
// src/utils/openai.ts -> analyzeFoodFromText()

if (config.food.useProductsDatabase) {
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑—É –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–¢–û–ß–ù–û!)
} else {
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –ò–ò (–º–µ–Ω–µ–µ —Ç–æ—á–Ω–æ)
}
```

### –®–∞–≥ 3: –ò–ò —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã (GPT-5-nano)
```typescript
// src/utils/openai.ts -> analyzeFoodIngredientsOnly()
```

**–ò–ò –¢–û–õ–¨–ö–û –Ω–∞—Ö–æ–¥–∏—Ç –ø—Ä–æ–¥—É–∫—Ç—ã –∏ –≤–µ—Å, –ù–ï —Å—á–∏—Ç–∞–µ—Ç –ö–ë–ñ–£:**
```json
{
  "dish_name": "–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ —Å –≥—Ä–µ—á–∫–æ–π",
  "ingredients": [
    {"product": "–∫—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞", "weight": 200},
    {"product": "–≥—Ä–µ—á–∫–∞ –≤–∞—Ä–µ–Ω–∞—è", "weight": 100}
  ]
}
```

### –®–∞–≥ 4: –ü–æ–∏—Å–∫ –≤ –±–∞–∑–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ üîç
```typescript
// src/utils/openai.ts -> enrichWithDatabaseNutrition()
```

**–î–ª—è –ö–ê–ñ–î–û–ì–û –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞:**

#### 4.1. –ü–æ–∏—Å–∫ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ –±–∞–∑–µ Supabase
```typescript
// src/database/products-queries.ts -> searchProduct()

const products = await searchProduct("–∫—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞", 3);
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–æ 3 –ø–æ—Ö–æ–∂–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å similarity score
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–∏—Å–∫:**
1. **Exact match** - —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è
2. **Fuzzy search (pg_trgm)** - –Ω–µ—á–µ—Ç–∫–∏–π –ø–æ–∏—Å–∫ (–Ω–∞–π–¥–µ—Ç "–∫—É—Ä–∏—Ü–∞", "–∫—É—Ä–∏–Ω–∞—è", "–∫—É—Ä–æ—á–∫–∞")
3. **Full-text search** - –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
4. **Similarity score** - –æ—Ü–µ–Ω–∫–∞ –ø–æ—Ö–æ–∂–µ—Å—Ç–∏ (0.0 - 1.0)

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```typescript
[
  {
    id: 164,
    name: "–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞",
    category: "–ú—è—Å–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã, –ø—Ç–∏—Ü–∞",
    protein: 23.6,  // –Ω–∞ 100–≥
    fat: 1.9,       // –Ω–∞ 100–≥
    carbs: 0,       // –Ω–∞ 100–≥
    calories: 113,  // –Ω–∞ 100–≥
    similarity: 0.95
  }
]
```

#### 4.2. –†–∞—Å—á–µ—Ç –ö–ë–ñ–£ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤–µ—Å–∞
```typescript
// src/database/products-queries.ts -> calculateNutritionForWeight()

calculateNutritionForWeight(product, 200); // 200 –≥—Ä–∞–º–º
```

**–†–∞—Å—á–µ—Ç:**
```
ratio = –≤–µ—Å / 100  // 200–≥ / 100 = 2.0
calories = product.calories * ratio  // 113 * 2.0 = 226 –∫–∫–∞–ª
protein = product.protein * ratio    // 23.6 * 2.0 = 47.2–≥
fat = product.fat * ratio            // 1.9 * 2.0 = 3.8–≥
carbs = product.carbs * ratio        // 0 * 2.0 = 0–≥
```

#### 4.3. –ï—Å–ª–∏ –ø—Ä–æ–¥—É–∫—Ç –ù–ï –ù–ê–ô–î–ï–ù –≤ –±–∞–∑–µ
```typescript
// Fallback –Ω–∞ AI –æ—Ü–µ–Ω–∫—É
const aiEstimate = await estimateNutritionWithAI("–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç", 150);
```

### –®–∞–≥ 5: –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ö–ë–ñ–£
```typescript
totalCalories = sum(–≤—Å–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã)
totalProtein = sum(–≤—Å–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã)
totalFat = sum(–≤—Å–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã)
totalCarbs = sum(–≤—Å–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã)
```

**–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "name": "–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ —Å –≥—Ä–µ—á–∫–æ–π",
  "ingredients": ["–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ 200–≥", "–ì—Ä–µ—á–∫–∞ –≤–∞—Ä–µ–Ω–∞—è 100–≥"],
  "weight": 300,
  "calories": 326,    // –¢–û–ß–ù–û –∏–∑ –±–∞–∑—ã!
  "protein": 51.3,    // –¢–û–ß–ù–û –∏–∑ –±–∞–∑—ã!
  "fat": 4.8,         // –¢–û–ß–ù–û –∏–∑ –±–∞–∑—ã!
  "carbs": 18.5       // –¢–û–ß–ù–û –∏–∑ –±–∞–∑—ã!
}
```

---

## üéØ –ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä—É—Ç–æ?

### ‚ùå –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ (—Ç–æ–ª—å–∫–æ –ò–ò):
```
"–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ 200–≥" ‚Üí –ò–ò —É–≥–∞–¥—ã–≤–∞–µ—Ç ‚Üí 350 –∫–∫–∞–ª ‚ùå (–ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∞!)
```

### ‚úÖ –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (–±–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤):
```
"–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ 200–≥" 
  ‚Üí –ò–ò —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç
  ‚Üí –ë–∞–∑–∞ –¥–∞–µ—Ç: 113 –∫–∫–∞–ª/100–≥
  ‚Üí –†–∞—Å—á–µ—Ç: 113 * 2 = 226 –∫–∫–∞–ª ‚úÖ (–¢–û–ß–ù–û!)
```

---

## üìà –¢–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å—á–µ—Ç–æ–≤

| –ò—Å—Ç–æ—á–Ω–∏–∫ | –¢–æ—á–Ω–æ—Å—Ç—å | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
|----------|----------|-------------------|
| **–ë–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤** | 95-99% | –ü—Ä–æ–¥—É–∫—Ç –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ (627 –ø—Ä–æ–¥—É–∫—Ç–æ–≤) |
| **–ò–ò –æ—Ü–µ–Ω–∫–∞** | 70-85% | –ü—Ä–æ–¥—É–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ |
| **–ò–ò –±–µ–∑ –±–∞–∑—ã** | 60-75% | –ë–∞–∑–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞ (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è) |

---

## üîß –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –ë–∞–∑–∞ –∏–∑ 627 –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ Supabase
- ‚úÖ Fuzzy search –∏ full-text search –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –≤ **—Ç–µ–∫—Å—Ç–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑**
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –≤ **–∞–Ω–∞–ª–∏–∑ –§–û–¢–û** üéâ
- ‚úÖ Fallback –Ω–∞ –ò–ò –µ—Å–ª–∏ –ø—Ä–æ–¥—É–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω

### ‚ö†Ô∏è –ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- ‚ö†Ô∏è –£–ª—É—á—à–∏—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Å–∏–Ω–æ–Ω–∏–º–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–∫—É—Ä–∏–Ω–æ–µ —Ñ–∏–ª–µ" = "–∫—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞")
- ‚ö†Ô∏è –†–∞—Å—à–∏—Ä–∏—Ç—å –±–∞–∑—É (–¥–æ–±–∞–≤–∏—Ç—å –≥–æ—Ç–æ–≤—ã–µ –±–ª—é–¥–∞, –Ω–µ —Ç–æ–ª—å–∫–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã)

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–µ –±–ª—é–¥–æ
**–í–≤–æ–¥:** "–û–≤—Å—è–Ω–∫–∞ 50–≥ —Å –±–∞–Ω–∞–Ω–æ–º"

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ò–ò —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç: –æ–≤—Å—è–Ω–∫–∞ (50–≥), –±–∞–Ω–∞–Ω (120–≥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π)
2. –ë–∞–∑–∞ –Ω–∞—Ö–æ–¥–∏—Ç: 
   - "–û–≤—Å—è–Ω—ã–µ —Ö–ª–æ–ø—å—è" ‚Üí 352 –∫–∫–∞–ª/100–≥
   - "–ë–∞–Ω–∞–Ω" ‚Üí 96 –∫–∫–∞–ª/100–≥
3. –†–∞—Å—á–µ—Ç:
   - –û–≤—Å—è–Ω–∫–∞: 352 * 0.5 = 176 –∫–∫–∞–ª
   - –ë–∞–Ω–∞–Ω: 96 * 1.2 = 115 –∫–∫–∞–ª
   - **–ò—Ç–æ–≥–æ: 291 –∫–∫–∞–ª** ‚úÖ

### –ü—Ä–∏–º–µ—Ä 2: –ñ–∞—Ä–µ–Ω–æ–µ –±–ª—é–¥–æ
**–í–≤–æ–¥:** "–ñ–∞—Ä–µ–Ω–∞—è —è–∏—á–Ω–∏—Ü–∞ 2 —è–π—Ü–∞"

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ò–ò —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç: —è–π—Ü–æ (2—à—Ç = 100–≥), –º–∞—Å–ª–æ –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–æ–µ (10–≥)
2. –ë–∞–∑–∞ –Ω–∞—Ö–æ–¥–∏—Ç:
   - "–Ø–π—Ü–æ –∫—É—Ä–∏–Ω–æ–µ" ‚Üí 157 –∫–∫–∞–ª/100–≥
   - "–ú–∞—Å–ª–æ –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–æ–µ" ‚Üí 899 –∫–∫–∞–ª/100–≥
3. –†–∞—Å—á–µ—Ç:
   - –Ø–π—Ü–∞: 157 * 1.0 = 157 –∫–∫–∞–ª
   - –ú–∞—Å–ª–æ: 899 * 0.1 = 90 –∫–∫–∞–ª
   - **–ò—Ç–æ–≥–æ: 247 –∫–∫–∞–ª** ‚úÖ

### –ü—Ä–∏–º–µ—Ä 3: –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç
**–í–≤–æ–¥:** "–≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–π —Ñ—Ä—É–∫—Ç –¥—É—Ä–∏–∞–Ω 100–≥"

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ò–ò —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç: –¥—É—Ä–∏–∞–Ω (100–≥)
2. –ë–∞–∑–∞ –Ω–∞—Ö–æ–¥–∏—Ç: "–î—É—Ä–∏–∞–Ω" ‚Üí **147 –∫–∫–∞–ª/100–≥** ‚úÖ (–µ—Å—Ç—å –≤ –±–∞–∑–µ!)
3. **–ò—Ç–æ–≥–æ: 147 –∫–∫–∞–ª** ‚úÖ

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–±—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è)

1. ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É –≤ –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ** - –ì–û–¢–û–í–û!
2. **–î–æ–±–∞–≤–∏—Ç—å —Å–∏–Ω–æ–Ω–∏–º—ã** (–∫—É—Ä–∏—Ü–∞ = –∫—É—Ä–∏–Ω–æ–µ —Ñ–∏–ª–µ = –∫—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞)
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. **–†–∞—Å—à–∏—Ä–∏—Ç—å –±–∞–∑—É** (–¥–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–∞, –Ω–µ —Ç–æ–ª—å–∫–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã)
5. **–£–ª—É—á—à–∏—Ç—å fuzzy search** (—É—á–∏—Ç—ã–≤–∞—Ç—å –æ–ø–µ—á–∞—Ç–∫–∏, —Ñ–æ—Ä–º—ã —Å–ª–æ–≤)

---

## üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Supabase
- **–¢–∞–±–ª–∏—Ü–∞:** `products_nutrition`
- **–ó–∞–ø–∏—Å–µ–π:** 627 –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏:** 17 –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- **–ò–Ω–¥–µ–∫—Å—ã:** 
  - `idx_products_name_normalized` (B-tree)
  - `idx_products_name_trgm` (GIN - fuzzy search)
  - `idx_products_name_search` (GIN - full-text)

### –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
USE_PRODUCTS_DATABASE=true  # –í–∫–ª—é—á–∏—Ç—å –±–∞–∑—É –ø—Ä–æ–¥—É–∫—Ç–æ–≤
```

### –§—É–Ω–∫—Ü–∏–∏
- `analyzeFoodFromText()` - –≥–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞
- `analyzeFoodIngredientsOnly()` - –ò–ò —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã
- `enrichWithDatabaseNutrition()` - –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –±–∞–∑—ã
- `searchProduct()` - –ø–æ–∏—Å–∫ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ –±–∞–∑–µ
- `calculateNutritionForWeight()` - —Ä–∞—Å—á–µ—Ç –ö–ë–ñ–£ –¥–ª—è –≤–µ—Å–∞

---

**–ê–≤—Ç–æ—Ä:** –î–∞–ï–¥–∞ –ë–æ—Ç ü§ñ  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-01-12

